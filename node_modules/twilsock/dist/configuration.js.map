{"version":3,"file":"configuration.js","sources":["../src/configuration.ts"],"sourcesContent":["import { LogLevelDesc } from \"loglevel\";\nimport { version } from \"../package.json\";\nimport type { ClientOptionsType } from \"./client\";\nimport { InitRegistration } from \"./protocol/initregistration\";\n\nexport type RetryPolicyType = {\n  min: number;\n  max: number;\n  initial?: number;\n  maxAttemptsCount?: number;\n  maxAttemptsTime?: number;\n  randomness?: number;\n};\n\n/**\n * Settings container for the Twilsock client library\n */\nclass Configuration {\n  private _token: string;\n  private _continuationToken: string | null;\n  public confirmedCapabilities: Set<string> = new Set<string>();\n\n  public readonly retryPolicy: RetryPolicyType;\n  public readonly url: string;\n  public readonly activeGrant: string;\n  public readonly logLevel: LogLevelDesc;\n  public readonly clientMetadata: Record<string, unknown>;\n  public readonly initRegistrations: InitRegistration[] | null;\n  public readonly tweaks: Record<string, unknown> | null;\n\n  /**\n   * @param {String} token - authentication token\n   * @param {Object} options - options to override defaults\n   */\n  constructor(\n    token: string,\n    activeGrant: string,\n    options: Partial<ClientOptionsType>\n  ) {\n    this.activeGrant = activeGrant;\n    this._token = token;\n\n    const region = options.region || \"us1\";\n    const defaultTwilsockUrl = `wss://tsock.${region}.twilio.com/v3/wsconnect`;\n\n    const twilsockOptions = options.twilsock || options.Twilsock || {};\n    this.url = twilsockOptions.uri || defaultTwilsockUrl;\n\n    this._continuationToken = options.continuationToken\n      ? options.continuationToken\n      : null;\n\n    this.logLevel = options.logLevel ? options.logLevel : \"error\";\n\n    this.retryPolicy = options.retryPolicy\n      ? options.retryPolicy\n      : {\n          min: 1 * 1000,\n          max: 2 * 60 * 1000,\n          randomness: 0.2,\n        };\n\n    this.clientMetadata = options.clientMetadata ? options.clientMetadata : {};\n    this.clientMetadata.ver = version;\n\n    this.initRegistrations = options.initRegistrations\n      ? options.initRegistrations\n      : null;\n\n    this.tweaks = options.tweaks ? options.tweaks : null;\n  }\n\n  public get token(): string {\n    return this._token;\n  }\n\n  public get continuationToken(): string | null {\n    return this._continuationToken;\n  }\n\n  public updateToken(token: string): void {\n    this._token = token;\n  }\n\n  public updateContinuationToken(continuationToken: string): void {\n    this._continuationToken = continuationToken;\n  }\n}\n\nexport { Configuration };\n"],"names":["version"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA;;AAEG;AACH,MAAM,aAAa,CAAA;AAajB;;;AAGG;AACH,IAAA,WAAA,CACE,KAAa,EACb,WAAmB,EACnB,OAAmC,EAAA;AAjB9B,QAAA,IAAA,CAAA,qBAAqB,GAAgB,IAAI,GAAG,EAAU,CAAC;AAmB5D,QAAA,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;AAC/B,QAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;AAEpB,QAAA,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,KAAK,CAAC;AACvC,QAAA,MAAM,kBAAkB,GAAG,CAAe,YAAA,EAAA,MAAM,0BAA0B,CAAC;QAE3E,MAAM,eAAe,GAAG,OAAO,CAAC,QAAQ,IAAI,OAAO,CAAC,QAAQ,IAAI,EAAE,CAAC;QACnE,IAAI,CAAC,GAAG,GAAG,eAAe,CAAC,GAAG,IAAI,kBAAkB,CAAC;AAErD,QAAA,IAAI,CAAC,kBAAkB,GAAG,OAAO,CAAC,iBAAiB;cAC/C,OAAO,CAAC,iBAAiB;cACzB,IAAI,CAAC;AAET,QAAA,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,GAAG,OAAO,CAAC;AAE9D,QAAA,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW;cAClC,OAAO,CAAC,WAAW;AACrB,cAAE;gBACE,GAAG,EAAE,CAAC,GAAG,IAAI;AACb,gBAAA,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;AAClB,gBAAA,UAAU,EAAE,GAAG;aAChB,CAAC;AAEN,QAAA,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,GAAG,EAAE,CAAC;AAC3E,QAAA,IAAI,CAAC,cAAc,CAAC,GAAG,GAAGA,gBAAO,CAAC;AAElC,QAAA,IAAI,CAAC,iBAAiB,GAAG,OAAO,CAAC,iBAAiB;cAC9C,OAAO,CAAC,iBAAiB;cACzB,IAAI,CAAC;AAET,QAAA,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;KACtD;AAED,IAAA,IAAW,KAAK,GAAA;QACd,OAAO,IAAI,CAAC,MAAM,CAAC;KACpB;AAED,IAAA,IAAW,iBAAiB,GAAA;QAC1B,OAAO,IAAI,CAAC,kBAAkB,CAAC;KAChC;AAEM,IAAA,WAAW,CAAC,KAAa,EAAA;AAC9B,QAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;KACrB;AAEM,IAAA,uBAAuB,CAAC,iBAAyB,EAAA;AACtD,QAAA,IAAI,CAAC,kBAAkB,GAAG,iBAAiB,CAAC;KAC7C;AACF;;;;"}