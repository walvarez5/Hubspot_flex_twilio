typeof window<"u"&&(window.global=window);import{__classPrivateFieldSet as l,__classPrivateFieldGet as e}from"../../../node_modules/tslib/tslib.es6.js";import{ProfileServiceImpl as d}from"../../backend/generated/ProfileConnector/api/profile.service.js";import"../logger/Logger/LogEntry.js";import{LoggerName as c}from"../logger/Logger/LoggerName.js";import{getLogger as h}from"../logger/LoggerFactory/getLogger.js";import"../logger/LoggerFactory/LoggerConfigImpl.js";import{SessionImpl as p}from"../session/Session/SessionImpl.js";var n,s,i;class w{constructor(r){n.set(this,void 0),s.set(this,void 0),i.set(this,void 0),l(this,n,r.getInstanceOf(d),"f"),l(this,i,h(r)(c.ProfileConnector),"f"),l(this,s,r.getInstanceOf(p),"f"),e(this,i,"f").info("ProfileConnectorImpl created!")}getIdentifiers(r){const o=e(this,s,"f").token;if(!o)throw e(this,i,"f").debug("getIdentifiers was called before FlexSDK.createClient"),new Error("getIdentifiers was called before FlexSDK.createClient");if(!r)throw e(this,i,"f").debug("getIdentifiers called without proper data"),new Error("getIdentifiers called without proper data");e(this,i,"f").info("Get Identifiers was called");try{const t=e(this,n,"f").getIdentifiers(r,{token:o});return Promise.resolve(t)}catch(t){return Promise.reject(t)}}getTraits(r){const o=e(this,s,"f").token;if(!o)throw e(this,i,"f").debug("getTraits was called before FlexSDK.createClient"),new Error("getTraits was called before FlexSDK.createClient");if(!r)throw e(this,i,"f").debug("getTraits called without proper data"),new Error("getTraits called without proper data");e(this,i,"f").info("GetTraits was called");try{const t=e(this,n,"f").getTraits(r,{token:o});return Promise.resolve(t)}catch(t){return Promise.reject(t)}}findProfileByIdentifiers(r){const o=e(this,s,"f").token;if(!o)throw e(this,i,"f").debug("findProfileByIdentifiers was called before FlexSDK.createClient"),new Error("findProfileByIdentifiers was called before FlexSDK.createClient");if(!r||!r.Attributes||!r.UniqueName)throw e(this,i,"f").debug("findProfileByIdentifiers called without proper data"),new Error("findProfileByIdentifiers called without proper data");e(this,i,"f").info("findProfileByIdentifiers was called");try{const t=new URLSearchParams;if(t.append("UniqueName",r.UniqueName),r.Attributes.forEach(a=>{t.append("Attributes",JSON.stringify(a))}),Object.prototype.hasOwnProperty.call(r,"WriteIfNotFound")){const a=r.WriteIfNotFound?"true":"false";t.append("WriteIfNotFound",a)}const f=e(this,n,"f").findProfileByIdentifiers(t.toString(),{token:o});return Promise.resolve(f)}catch(t){return Promise.reject(t)}}findProfileByUniqueId(r,o){const t=e(this,s,"f").token;if(!t)throw e(this,i,"f").debug("findProfileByUniqueId was called before FlexSDK.createClient"),new Error("findProfileByUniqueId was called before FlexSDK.createClient");if(!r||!o)throw e(this,i,"f").debug("findProfileByUniqueId called without proper data"),new Error("findProfileByUniqueId called without proper data");e(this,i,"f").info("findProfileByUniqueId was called");try{return e(this,n,"f").findProfileByUniqueId(r,o,{token:t})}catch(f){return Promise.reject(f)}}}n=new WeakMap,s=new WeakMap,i=new WeakMap;export{w as ProfileConnectorImpl};
//# sourceMappingURL=ProfileConnectorImpl.js.map
