/*!
 * 
 * @twilio/flex-sdk.js 0.99.32-dev
 * The following license applies to all parts of this software except as documented below.
 *
 * Copyright (c) 2020 Twilio, Inc.
 * All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the “License”);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an “AS IS” BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */(()=>{"use strict";var e={d:(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r),e.d(r,{FlexDataClientError:()=>x.ApolloError,FlexDataClientLink:()=>x.ApolloLink,FlexDataProvider:()=>S,MockedProvider:()=>F.MockedProvider,Observable:()=>x.Observable,createDataClient:()=>P,execute:()=>x.execute,gql:()=>D.gql,onError:()=>t.onError,useFlexLazyQuery:()=>x.useLazyQuery,useFlexMutation:()=>x.useMutation,useFlexQuery:()=>x.useQuery,useFlexSubscription:()=>x.useSubscription});const t=require("@apollo/client/link/error"),n=(require("core-js/modules/es.array.concat.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("regenerator-runtime/runtime.js"),require("@apollo/client/core")),o=require("@apollo/client/link/http"),i=require("@apollo/client/link/retry"),a=require("@apollo/client/link/core"),c=require("@apollo/client/link/subscriptions"),l=require("@apollo/client/utilities"),u=require("@apollo/client/link/context"),s=require("graphql-ws"),p=require("ws"),f=require("graphql");function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function b(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var v=function(){var e;return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){b(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},null===(e=window.__TWILIO_FLEX_SDK__)||void 0===e?void 0:e.environmentConfig)};require("core-js/modules/es.string.starts-with.js");function y(e){switch(e){case"prod":case"us1":case"":return"";case"dev-us1":return".dev";case"stage-us1":return".stage";default:return".".concat(e)}}var h=function(e){return e.GraphqlFetchRemoteSchemaFailed="Failed to fetch remote GraphQL schema",e.GraphqlLocalSchemaFailed="Failed to make local GraphQL schema",e.GraphqlSchemaStitchingFailed="Failed to stitch GraphQL schemas",e.GraphqlApolloClientInitializationFailed="Failed to initialize Apollo Client",e}({});var m=new(require("@apollo/client/cache").InMemoryCache)({});function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){O(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function O(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function w(e,r,t,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void t(e)}c.done?r(l):Promise.resolve(l).then(n,o)}function q(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var i=e.apply(r,t);function a(e){w(i,n,o,a,c,"next",e)}function c(e){w(i,n,o,a,c,"throw",e)}a(void 0)}))}}var P=function(){var e=q(regeneratorRuntime.mark((function e(r,t){var d,b,g,O,w,P,k,x,S,F,D,L,C,E,G,R,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 8e3,e.prev=1,O=v(),w=(O||{}).region,P=y(w||(null==t?void 0:t.region)||""),k="wss://event-bridge".concat(P,".twilio.com/graphql-subscriptions"),x="https://preview".concat(P,".twilio.com/Flex/graphql"),S="function"==typeof r,F=[],null!=t&&t.errorLink&&F.push(t.errorLink),D=(0,u.setContext)(function(){var e=q(regeneratorRuntime.mark((function e(t,n){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.headers,!S){e.next=7;break}return e.next=4,r();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=r;case 8:return i=e.t0,a=btoa("token:".concat(i)),e.abrupt("return",{headers:j(j({},o),{},{authorization:a?"Basic ".concat(a):""})});case 11:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()),F.push(D),L=new i.RetryLink({attempts:{max:5},delay:{initial:1e3,max:3e3}}),F.push(L),C=function(){return new n.ApolloLink((function(e,r){var t=e.getContext().headers,n=(0,f.print)(e.query),i=JSON.stringify(t).length,a=JSON.stringify(e.variables),c="".concat(x,"?query=").concat(encodeURIComponent(n),"&variables=").concat(encodeURIComponent(a)).length+i<=8e3;return new o.HttpLink({uri:x,useGETForQueries:c}).request(e,r)}))},F.push(C()),E=k,G=new c.GraphQLWsLink((0,s.createClient)(j(j({url:E},void 0===p.WebSocket&&{webSocketImpl:p.WebSocket}),{},{connectionParams:function(){var e=q(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="Bearer ",!S){e.next=7;break}return e.next=4,r();case 4:e.t1=e.sent,e.next=8;break;case 7:e.t1=r;case 8:return e.t2=e.t1,e.t3=e.t0.concat.call(e.t0,e.t2),e.abrupt("return",{authToken:e.t3});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}))),R=(0,n.split)((function(e){var r=e.query,t=(0,l.getMainDefinition)(r);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),G,(0,a.from)(F)),null!=t&&t.typePolicies&&m.policies.addTypePolicies(null==t?void 0:t.typePolicies),T=new n.ApolloClient({cache:m,connectToDevTools:null!==(d=null==t?void 0:t.connectToDevTools)&&void 0!==d&&d,link:R,defaultOptions:{query:{fetchPolicy:"network-only",errorPolicy:"all"}},typeDefs:null==t||null===(b=t.localSchema)||void 0===b?void 0:b.typeDefs,resolvers:null==t||null===(g=t.localSchema)||void 0===g?void 0:g.resolvers}),e.abrupt("return",Promise.resolve(T));case 24:throw e.prev=24,e.t0=e.catch(1),new Error(h.GraphqlApolloClientInitializationFailed);case 27:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(r,t){return e.apply(this,arguments)}}();const k=require("react"),x=require("@apollo/client");var S=function(e){var r=e.children,t=e.dataClient;return k.createElement(k.Fragment,null,t&&k.createElement(x.ApolloProvider,{client:t},r))};S.displayName="DataProvider";const F=require("@apollo/client/testing"),D=require("graphql-tag");module.exports=r})();
//# sourceMappingURL=index.js.map