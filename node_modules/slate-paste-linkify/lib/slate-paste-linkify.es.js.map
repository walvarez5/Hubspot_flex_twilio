{"version":3,"file":"slate-paste-linkify.es.js","sources":["../src/index.js"],"sourcesContent":["import isUrl from 'is-url'\n\nexport default function PasteLinkify(options = {}) {\n  const {\n    isActiveQuery = 'isLinkActive',\n    wrapCommand = 'wrapLink',\n    unwrapCommand = 'unwrapLink',\n  } = options\n\n  return {\n    onCommand(command, change, next) {\n      const { type, args } = command\n      const { value } = change\n      const { selection } = value\n      const { isCollapsed, start } = selection\n      let url\n\n      if (\n        (type === 'insertText' && isUrl((url = args[0]))) ||\n        (type === 'insertFragment' && isUrl((url = args[0].text)))\n      ) {\n        // If there is already a link active, unwrap it so that we don't end up\n        // with a confusing overlapping inline situation.\n        if (change.query(isActiveQuery, value)) {\n          change.command(unwrapCommand)\n        }\n\n        // If the selection is collapsed, we need to allow the default inserting\n        // to occur instead of just wrapping the existing text in a link.\n        if (isCollapsed) {\n          next()\n          change\n            .moveAnchorTo(start.offset)\n            .moveFocusTo(start.offset + url.length)\n        }\n\n        // Wrap the selection in a link, and collapse to the end of it.\n        change.command(wrapCommand, url).moveToEnd()\n        return\n      }\n\n      next()\n    },\n  }\n}\n"],"names":["PasteLinkify","options","isActiveQuery","wrapCommand","unwrapCommand","command","change","next","type","args","value","selection","isCollapsed","start","url","isUrl","text","query","moveAnchorTo","offset","moveFocusTo","length","moveToEnd"],"mappings":";;AAEe,SAASA,YAAT,GAAoC;MAAdC,OAAc,uEAAJ,EAAI;8BAK7CA,OAL6C,CAE/CC,aAF+C;MAE/CA,aAF+C,yCAE/B,cAF+B;6BAK7CD,OAL6C,CAG/CE,WAH+C;MAG/CA,WAH+C,wCAGjC,UAHiC;8BAK7CF,OAL6C,CAI/CG,aAJ+C;MAI/CA,aAJ+C,yCAI/B,YAJ+B;;;SAO1C;aAAA,qBACKC,OADL,EACcC,MADd,EACsBC,IADtB,EAC4B;UACvBC,IADuB,GACRH,OADQ,CACvBG,IADuB;UACjBC,IADiB,GACRJ,OADQ,CACjBI,IADiB;UAEvBC,KAFuB,GAEbJ,MAFa,CAEvBI,KAFuB;UAGvBC,SAHuB,GAGTD,KAHS,CAGvBC,SAHuB;UAIvBC,WAJuB,GAIAD,SAJA,CAIvBC,WAJuB;UAIVC,KAJU,GAIAF,SAJA,CAIVE,KAJU;;UAK3BC,YAAJ;;UAGGN,SAAS,YAAT,IAAyBO,MAAOD,MAAML,KAAK,CAAL,CAAb,CAA1B,IACCD,SAAS,gBAAT,IAA6BO,MAAOD,MAAML,KAAK,CAAL,EAAQO,IAArB,CAFhC,EAGE;;;YAGIV,OAAOW,KAAP,CAAaf,aAAb,EAA4BQ,KAA5B,CAAJ,EAAwC;iBAC/BL,OAAP,CAAeD,aAAf;;;;;YAKEQ,WAAJ,EAAiB;;iBAGZM,YADH,CACgBL,MAAMM,MADtB,EAEGC,WAFH,CAEeP,MAAMM,MAAN,GAAeL,IAAIO,MAFlC;;;;eAMKhB,OAAP,CAAeF,WAAf,EAA4BW,GAA5B,EAAiCQ,SAAjC;;;;;;GA5BN;;;;;"}